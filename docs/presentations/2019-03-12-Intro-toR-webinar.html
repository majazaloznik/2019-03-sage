<!DOCTYPE html>
<html>
  <head>
    <title>Introduction to R for Social Scientists</title>
    <meta charset="utf-8">
    <meta name="author" content="Maja Založnik" />
    <meta name="date" content="2019-03-12" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introduction to R for Social Scientists
### Maja Založnik
### 12 March 2019

---


# Outline

* What exactly is R and why do we use it?

* Data visualisation and interactivity in R

* The Rstudio way of interfacing with R 

* The R language simplified

* A demonstration of how to create a regression model using R

---

#  What exactly is R and why do we use it?

--

`1.`  R is a programming language

???
R is two things: language for statistical computing. an actual programming language. This can be a bit scary at first, but trust me, it's worth it.  

--

`2.`  R is an environment for data analysis 

???
Because R is also complete environment for data analysis, a comprehensive platform for data management, data exploration, data analysis and data visualisation as well as reporting and presenting your analysis. 

--

R is one of the most popular platforms for data analysis, with an expanding user base as well as ever expanding funcitonality.

--

So is it worth learnigng?

???
Like learning anything new, learning R takes a bit of effort. But you do not need to be a computer scientist to use R, i'm definitely not :)

Now although we don't have a lot of time today, I will try to give you a flavour of why you might want to take the plunge and learn R. 


---
#  What exactly is R and why do we use it?

* R is free, open source and available on all three major platforms.

???
So is it worth learning  In a way I guess it depends on what your alternative is. If it is another statistical software package, then you want to be careful if it is a commercial package. 

That means you are tied to licences, that can be very expensive.  With R you are no longer dependent on this. 

Because R is opensource and free, and available on Widnows, Mac and linux. That means you can change employers, universities, operating systems and not worry about being able to continue your work. 

You will also be able to import data in a number of proprietary formats, including Excel, SPSS, STATA and others. You can also interface with python, julia, netlogo, matlab, or any number of analytical tools you can think of if you want to harness the best of both worlds. 

---
#  What exactly is R and why do we use it?

* R is free, open source and available on all three major platforms.

* Countless extensions (packages) and interfaces with other programmes

???
One of the advantages of R being open source is that anyone can contribute to its development. Of course it would quickly become unwieldy if downloading R meant also downloading everyone elses contributions.  

But you don't have to, Instead you only download a base version of R and then you can supplement this installation by loading additional packages as and when required. These packages are extensions that have been written by other users and made available for free. 

Packages contain functions and or datasets that are not available in the base instllation. 

The official repository for pakcages is called CRAN and all packages, almost 14,000 of them, are fully documented with standard format help files. 


---
#  What exactly is R and why do we use it?

* R is free, open source and available on all three major platforms.

* Countless extensions (packages) and interfaces with other programmes

* Great community 

???
This is one of my favourite parts of the R ecosystem, community that comes along with it. More often than not, a problem that you are trying to solve was already attempted by someone else and you can 

* easily access their code, 
* and use their functions directly, 
* or use their code as a template to tweak according to your needs. 
* You can even contact the authors themselves and suggest some function that their package is missing and they might want to add.

The R community takes various shapes and forms, you can find helpful folk on dedicated forums and  community websites, mailing lists and even by following the #rstats on twitter.  

---
#  What exactly is R and why do we use it?

* R is free, open source and available on all three major platforms.

* Countless extensions (packages) and interfaces with other programmes

* Great community 

* Making reproducibile research the norm

???
I want to quickly mention reproduciblitity and the importance of scripting.

Many data analysis and data visualisation tools rely on point and click actions. 

This can be great, especially if you want to do something quick and dirty, but such work is not reproducible. It is also prone to error as anyone who has tried to highlight a few columns of cells in Excel knows. 

Instead using scripts, or code, to conduct your analysis, means that everything from importing the data, exploring it, running the analysis, creating the visualisations, and preparing the reports, presentations or papers is recorded

It means you can rerun the analysis simply, you are transparent about the exact steps you took, to your collaborators, your peers, and most importantly, to yourself. 

---
#  What exactly is R and why do we use it?

* R is free, open source and available on all three major platforms.

* Countless extensions (packages) and interfaces with other programmes

* Great community 

* Making reproducibile research the norm

* Excellent data visualisation capabilities

???
Finally, data visualisation. R has i have to say spectacular data visualisation capabilities. I won't talk too much about this, really, I though I'd just show you a few random examples of things I've done with R graphics, to give you a flavour

---
# Dataviz examples
### Lexis maps - Death rates 14 European countries 

&lt;img src="figures/lexis.jpg" width="1309" /&gt;

???
So here's an example of a heatmap, this is pretty much out of the box, looking at death rates in 14 european countries that have data going back to 1900. I like this chart because it is so simple but tells so many stories when you look at it a bit more closely. Like you can see the first world war ad the second, 

You can see the impact they had on civilians, by looking at the difference between women and men. You can aslo see this really unusual line here, this blip of low mortality of people who were born in 1918, which is when the spanish flu epidemic was raging. 
---
# Dataviz examples
### Lexis maps - Population policy in Sub-saharan Africa

&lt;img src="figures/policy.jpg" width="1116" /&gt;

???
Here's a more bespoke example, this is african governments views on population growth and policies. I made this for a publication that needed to be printed in black and white.

It shows how the views have changed over time on the continet as a whole and in regions separately. For example most of Southern african countries now think their population growth rates are satisfactory, or even too low, while the rest of the continent is slowly moving towards seeing their growth rates as being too high. 

---
# Dataviz examples
### Local Autocorrelation--UK census 2001

&lt;img src="figures/lisa1.jpg" width="1300" /&gt;

???
You can also do spatial analysis in R, and all sorts of mapping. This is data from the UK census, a cloropleth map of the proportion of households in each area that own more than two cars. 

This is a more complex layout, which includes a zoom in into the London area, and this little neat density curve under the legend, giving you an idea of the ovreall distribution.

---
# Dataviz examples
### Local Autocorrelation--UK census 2001

&lt;img src="figures/lisa2.jpg" width="1253" /&gt;

---
# Dataviz examples
### Stacked bar charts: Household living arrangements of older people

&lt;img src="figures/botswana.jpg" width="700px" /&gt;
???
This is a version of the spatial autocorrelation analysis map, which usually uses two maps to show the significance of the local autocorrelation, but instead here I used a little x to mark non-significant areas, and larger circles to show significance. 

---
# Dataviz examples--animation
### Korea: Population pyramid

![](figures/pyramid_65_Republic_of_Korea_1980-2015.gif)&lt;!-- --&gt;

???
You can also make animated charts in R, and save them as gifs. Because I'm a demographer I have a soft spot for population pyramids, so here's one of Korea's population growing older, you can see the year changing up in the corner there. 

This is perhaps not super useful from a scientific point of view, but anyone who has used twitter knows how a good gif can attract much more attention than a link to a pdf publication.. So it's not a bad skill to acquire :)

---
# Dataviz examples--animation
### Korea: Population pyramid

![](figures/pyramid_65_Republic_of_Korea_2015-2050.gif)&lt;!-- --&gt;
---
# Dataviz examples--interactivity

&lt;img src="figures/vietnam.jpg" width="700px" /&gt;
[Interactive datavis solution using `shiny` in R](https://maja.shinyapps.io/VHLSS/)

???
And finally I wanted to show you an example of interactive data visualisation, this is an example of a chart I did of the farm sizes of Vietnamese households in a farmin survey, and there's quite a lot going on here, and maybe a bit difficult to compare the different provinces, there's fourteen here. 

So I turned this chart into an interactive one using shiny, which is an r package for creating interactive visualisations. So let's see if I can get it up and running.



---

# Dataviz examples-galleries

[https://www.r-graph-gallery.com/](https://www.r-graph-gallery.com/)



[https://shiny.rstudio.com/gallery/](https://shiny.rstudio.com/gallery/)

---

# Rstudio


* Difference between plain old R and Rstudio.

???
Just to clarify a bit of terminology, you should be able to distinguish between R and RStudio. R is the programming language and the suite of software facilities for data analysis and visualisation. Once you've installed R you can use it from a rather basic console. 

However you will find interacting with R a lot easier and more familiar if you use RStudio, which is an IDE or integrated development environment for using R. There have been several other IDEs for R over the years, and in fact you can also use R in other environments such as emacs or vim if you prefer. 

But Rstudio has become quite a leader in the field and integrates many functions that make using R much easier and enhancing your workflow, and is super user friendly with a great community. 

It makes it particularly easy to do everyday tasks, as well as things like creating interactive visualisations like I showed you, or directly writing reports, presentations and papers, and I'll get back to that at the end of the presentation.

--

* Rstudio layout:
  + console---command window
  + script window---editor
  + workspace &amp; history window + more
  + files, plots, packages, help + more

???
Now however it is time to switch gear, and have a look at R in practice. So let me show you the Rstudio layout, well, by actually showing you the Rstudio layout. 
---
# Rstudio

???
So this is a fresh install of both R and Rstudio on a Windows machine. 

OK, we'll start in the left, this is the console, or the command window. 

This little 'greater than' sign is the prompt where you can type in commands and where R executes them. 

A quick example 

In practice you will actually want to avoid typing directly into the console, because typing into the console is not reproducible. You want to be able to rerun your code in a way that it executes the same way, so instead we type code into a script file. 

I will open a new scripting file, which fits in the fourth panel on the top left here. So now I can type in some code into the scripting file, and run it from there. I can do this by highlighting it and clicking the run button, or by using the keyboard shortcut Ctrl+enter. In fact I don't even need to highlight it, it's enough that I have the cursor placed inside a command and it will be executed, even if it spans several rows. 

Let's have a quick look at the other panes as well.. 

---
# The R language simplified
## variable assignment

```r
height &lt;- 11
width &lt;- 5
height
```

```
## [1] 11
```

```r
width
```

```
## [1] 5
```

```r
area &lt;- height * width
area 
```

```
## [1] 55
```

???
So I now want to very quickly go through a few basics of the R language, just to make you a bit more familiar, and to show you it's not tricky at all. 

So the first thing to understand is the assignment of variables. The assignment operator in R is this combination of symbols, smaller than and dash, or hyphen. 



---
# The R language simplified

### vectors and data types 


```r
# numeric vectors
vec1 &lt;- c(20, 33, 41, 22, 12)
# string  vectors
vec3 &lt;- c("Maja", "Michael", "Amy", "Nabila", "Taylor")
vec3
```

```
## [1] "Maja"    "Michael" "Amy"     "Nabila"  "Taylor"
```

```r
# logical vectors 
vec4 &lt;- c(TRUE, FALSE, FALSE, TRUE, TRUE)
vec4
```

```
## [1]  TRUE FALSE FALSE  TRUE  TRUE
```

```r
vec3[3]
```

```
## [1] "Amy"
```
???
Now you normally wouldn't be working with single numbers, but with variables, especially if you are a social scientist, you want a way to represent variables. 

In R you do that using vectors. And we have different types of vectors, most common ones are numeris, string and logical, so let's try a few of those. 

And you will notice that vecotrs have to be of the same type, you cannot mix data types in R!

---
# The R language simplified

### functions in base R

```r
mean(vec1)
```

```
## [1] 25.6
```

???
Functions play an important role in R, we've already seen one, that was c(), but there are countless others. For example if we want to calculate the average of the vector1, we would use mean(vec1). 

Functions usually take argumets, here the mean function takes the argumenet the vector that we want to calculate the average of. Other functions can take many more arguments. 

For example the function rnorm takes three arguments, we can have a look at the help file to see that. 

In R you don't even have to name the arguments, if it is obvious what they are, because of the order in which you enter them. So in this example we don't have to write sd = 2, we can just write 2. 

You can get more funcitons by loading additional packages, but of course you can also write your own! But we don't have time for that today unfortunately, so let's press on. 

---
# The R language simplified
### data frames


```r
vec5 &lt;- c(1981, 1974, 1993, 1957, 1971)
```

???
So as social scientists what we all really want is a table of data. In R tables are called data.frames. And they are simply a collection of vectors. 

You will remember I said before that vectors have to be of a single data type, numeric or string for example, now that makes sense, they are variables, and in a data.frame, they become the columns of the table. 

That means they also have to all be the same length. So let's create a data frame. 
---
# The R language simplified
### data frames


```r
vec5 &lt;- c(1981, 1974, 1993, 1957, 1971)

my.df &lt;- data.frame(year.born = vec5, 
                    name = vec3, 
                    rps = vec1,  
                    like.white.choc = vec4)
my.df
```

```
##   year.born    name rps like.white.choc
## 1      1981    Maja  20            TRUE
## 2      1974 Michael  33           FALSE
## 3      1993     Amy  41           FALSE
## 4      1957  Nabila  22            TRUE
## 5      1971  Taylor  12            TRUE
```

???
Now one last thing we need to know about dataframes is how to access a column in a dataframe. To do this we use the `$ `operator, so df$like.white.choc is how you access that column. 

SO let's use that to draw a quick plot. 

There, so that's just the shortest possible overview that should hopefully allow you to follow the next bit, which is a bit of regression analysis with an actual dataset.

So in order not to bore you too much with my slow typing, I've prepared the script for the regression analysis in advance, so I don't slow us down too much. 
---
# Linear Regression Modelling in R


```r
# load data and explore
library(gapminder)
head(gapminder)
```

```
## # A tibble: 6 x 6
##   country     continent  year lifeExp      pop gdpPercap
##   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
## 1 Afghanistan Asia       1952    28.8  8425333      779.
## 2 Afghanistan Asia       1957    30.3  9240934      821.
## 3 Afghanistan Asia       1962    32.0 10267083      853.
## 4 Afghanistan Asia       1967    34.0 11537966      836.
## 5 Afghanistan Asia       1972    36.1 13079460      740.
## 6 Afghanistan Asia       1977    38.4 14880372      786.
```

```r
length(unique(gapminder$country))
```

```
## [1] 142
```

```r
min(gapminder$year)
```

```
## [1] 1952
```

```r
max(gapminder$year)
```

```
## [1] 2007
```
---
# Linear Regression Modelling in R


```r
plot(jitter(gapminder$year), gapminder$lifeExp)
```

![](2019-03-12-Intro-toR-webinar_files/figure-html/unnamed-chunk-15-1.png)&lt;!-- --&gt;
---
# Linear Regression Modelling in R


```r
reg1 &lt;- lm(lifeExp ~ year, data = gapminder)

summary(reg1)
```

```
## 
## Call:
## lm(formula = lifeExp ~ year, data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -39.949  -9.651   1.697  10.335  22.158 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -585.65219   32.31396  -18.12   &lt;2e-16 ***
## year           0.32590    0.01632   19.96   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 11.63 on 1702 degrees of freedom
## Multiple R-squared:  0.1898,	Adjusted R-squared:  0.1893 
## F-statistic: 398.6 on 1 and 1702 DF,  p-value: &lt; 2.2e-16
```

---
# Linear Regression Modelling in R


```r
plot(jitter(gapminder$year), gapminder$lifeExp)
abline(reg1$coefficients, col = "red", lwd = 3)
```

&lt;img src="2019-03-12-Intro-toR-webinar_files/figure-html/unnamed-chunk-17-1.png" height="450px" /&gt;

---
# Linear Regression Modelling in R


```r
reg2 &lt;- lm(lifeExp ~ gdpPercap, data = gapminder)
summary(reg2)
```

```
## 
## Call:
## lm(formula = lifeExp ~ gdpPercap, data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -82.754  -7.758   2.176   8.225  18.426 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 5.396e+01  3.150e-01  171.29   &lt;2e-16 ***
## gdpPercap   7.649e-04  2.579e-05   29.66   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10.49 on 1702 degrees of freedom
## Multiple R-squared:  0.3407,	Adjusted R-squared:  0.3403 
## F-statistic: 879.6 on 1 and 1702 DF,  p-value: &lt; 2.2e-16
```

---
# Linear Regression Modelling in R


```r
plot(gapminder$gdpPercap, gapminder$lifeExp)
abline(reg2$coefficients, col = "red", lwd = 3)
```

&lt;img src="2019-03-12-Intro-toR-webinar_files/figure-html/unnamed-chunk-19-1.png" height="450px" /&gt;

---
# Bivariate regression 2


```r
reg3 &lt;- lm(lifeExp ~ log(gdpPercap), data = gapminder)
summary(reg3)
```

```
## 
## Call:
## lm(formula = lifeExp ~ log(gdpPercap), data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -32.778  -4.204   1.212   4.658  19.285 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -9.1009     1.2277  -7.413 1.93e-13 ***
## log(gdpPercap)   8.4051     0.1488  56.500  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 7.62 on 1702 degrees of freedom
## Multiple R-squared:  0.6522,	Adjusted R-squared:  0.652 
## F-statistic:  3192 on 1 and 1702 DF,  p-value: &lt; 2.2e-16
```
---
## Bivariate regression with transformed variable


```r
plot(log(gapminder$gdpPercap), gapminder$lifeExp)
abline(reg3$coefficients, col = "red", lwd = 3)
```

&lt;img src="2019-03-12-Intro-toR-webinar_files/figure-html/unnamed-chunk-21-1.png" height="450px" /&gt;

---
## Multiple regression


```r
reg4 &lt;- lm(lifeExp ~ log(gdpPercap) + year, data = gapminder)
summary(reg4)
```

```
## 
## Call:
## lm(formula = lifeExp ~ log(gdpPercap) + year, data = gapminder)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -27.2291  -3.8454   0.6065   4.7737  17.8644 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -3.911e+02  1.942e+01  -20.14   &lt;2e-16 ***
## log(gdpPercap)  7.770e+00  1.381e-01   56.27   &lt;2e-16 ***
## year            1.956e-01  9.927e-03   19.70   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6.877 on 1701 degrees of freedom
## Multiple R-squared:  0.7169,	Adjusted R-squared:  0.7165 
## F-statistic:  2153 on 2 and 1701 DF,  p-value: &lt; 2.2e-16
```

---
## Multiple regression with categorical variable


```r
gapminder.2007 &lt;- subset(gapminder, year == 2007)
reg5 &lt;- lm(lifeExp ~ log(gdpPercap)  + continent, data = gapminder.2007)
summary(reg5)
```

```
## 
## Call:
## lm(formula = lifeExp ~ log(gdpPercap) + continent, data = gapminder.2007)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19.4917  -2.3146  -0.0432   2.5498  14.8818 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        20.1376     4.0332   4.993 1.79e-06 ***
## log(gdpPercap)      4.6308     0.5274   8.780 6.14e-15 ***
## continentAmericas  11.6942     1.6546   7.068 7.46e-11 ***
## continentAsia      10.1144     1.4761   6.852 2.31e-10 ***
## continentEurope    11.2682     1.8936   5.951 2.14e-08 ***
## continentOceania   12.9293     4.5211   2.860  0.00491 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 5.929 on 136 degrees of freedom
## Multiple R-squared:  0.7674,	Adjusted R-squared:  0.7588 
## F-statistic: 89.72 on 5 and 136 DF,  p-value: &lt; 2.2e-16
```
---
## Multiple regression with categorical variable

![](2019-03-12-Intro-toR-webinar_files/figure-html/unnamed-chunk-24-1.png)&lt;!-- --&gt;
---
## Multiple regression with interaction term


```
## 
## Call:
## lm(formula = lifeExp ~ log(gdpPercap) * continent, data = gapminder.2007)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19.1483  -2.4726  -0.0517   2.2124  15.4213 
## 
## Coefficients:
##                                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                       22.90682    6.22285   3.681 0.000337 ***
## log(gdpPercap)                     4.26088    0.82373   5.173 8.36e-07 ***
## continentAmericas                 10.15826   15.68051   0.648 0.518222    
## continentAsia                      2.74329    9.80627   0.280 0.780108    
## continentEurope                   12.53213   19.92268   0.629 0.530411    
## continentOceania                  23.89890  279.39987   0.086 0.931964    
## log(gdpPercap):continentAmericas   0.23319    1.79057   0.130 0.896581    
## log(gdpPercap):continentAsia       0.89638    1.18998   0.753 0.452625    
## log(gdpPercap):continentEurope    -0.03398    2.06360  -0.016 0.986886    
## log(gdpPercap):continentOceania   -0.96521   27.15408  -0.036 0.971698    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6.004 on 132 degrees of freedom
## Multiple R-squared:  0.7685,	Adjusted R-squared:  0.7527 
## F-statistic: 48.68 on 9 and 132 DF,  p-value: &lt; 2.2e-16
```
---
## Multiple regression with interaction term

![](2019-03-12-Intro-toR-webinar_files/figure-html/unnamed-chunk-26-1.png)&lt;!-- --&gt;

---

## Multiple regression with interaction term
![](2019-03-12-Intro-toR-webinar_files/figure-html/unnamed-chunk-27-1.png)&lt;!-- --&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
